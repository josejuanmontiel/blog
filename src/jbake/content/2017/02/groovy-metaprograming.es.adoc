= Groovy Metaprograming
Jose Juan Montiel
2017-02-03
:jbake-type: post
:jbake-tags: jvm,code,generation,groovy, thymeleaf
:jbake-status: draft
:jbake-lang: es
:source-highlighter: prettify
:id: thymeleaf
:icons: font

== Generacion de codigo. Del modelo a la vista.

En https://josejuanmontiel.github.io/blog/2016/10/groovy-thymelaf.es.html[uno]
de mis anteriores artículos, hablaba de como, usando Groovy y Thymeleaf, se podía
separar aun un poco mas, la maqueta de las indicaciones de donde colocar los
elementos de binding, para mostrar los datos del modelo; y deje planteado unos
próximos pasos, de como se podía generar parte de ese código.

A día de hoy, existen muchas maneras de "generar codigo". Por ejemplo, en
http://www.genbetadev.com/paradigmas-de-programacion/metaprogramacion-en-compile-time-con-groovy[este articulo]
Ivan nos cuenta muy detalladamente las opciones que hay en groovy.

Y en http://www.madridgug.com/2016/11/madrid-gug-diciembre-2016-macro-macro.html[esta charla],
Mario, se centra en las ayudas que existen para la Metaprogramacion en groovy, los macros.

Si tuvieramos que hacer una clasificacion, diferente, de las distintas maneras de crear codigo podriamos hacerlo asi:

. Las de java
.. Las que se ven
... Las que generan codigo fuente
**** Cosas como http://docs.spring.io/spring-roo/reference/html/intro.html[Spring Roo] o http://yeoman.io[Yeoman] son herramientas que generan codigo "scaffolding".
**** Pero cosas como esta libreria https://github.com/square/javapoet[Javapoet] genera codigo fuente, a partir de un DSL, y asi partimos de unos fuentes comunes.
... Las que generan codigo compilado. http://docs.oracle.com/javase/7/docs/technotes/guides/apt/[APT].
**** Por ejemplo, esta libreria, https://github.com/AlbertoSH/MagicBuilder[MagicBuilder]
genera codigo en tiempo de compilacion, siguiendo el patron builder.
.. Las que no se ven
... Las que usan injeccion de dependencias
... Generan/modifican codigo en tiempo de ejecucion
**** http://asm.ow2.org/[ASM4]
**** http://bytebuddy.net/#/[ByteBuddy]
***** https://github.com/raphw/byte-buddy
***** https://github.com/raphw/byte-buddy/tree/master/byte-buddy-android
***** https://github.com/spring-projects/spring-boot/blob/1.4.x/spring-boot-integration-tests/spring-boot-devtools-tests/src/test/java/org/springframework/boot/devtools/tests/DevToolsIntegrationTests.java#L179-L188
... Las que cambian el codigo en produccion mediante dinamic attach. https://www.sitepoint.com/fixing-bugs-in-running-java-code-with-dynamic-attach/[Dynamic attach].
**** En esta charla, nos cuentan  como usar http://www.madridgug.com/2015/11/codemotion-2015-jose-miguel-rodriguez.html[YouDebug] como un depurador interactivo en produccion.
... Las que compilan codigo desde unos fuentes en produccion. https://blog.frankel.ch/compilation-java-code-on-the-fly/#gsc.tab=0[Compile sources en runtime].
. Las de mundo groovy
.. Metaprogramacion en compilacion
.. Metaprogramacion en ejecucion
. El mundo android
.. Asistidas por gradle (con el plugin APT)
*** https://google.github.io/dagger/users-guide[Dagger]
*** http://jakewharton.github.io/butterknife/[Butterknife]
- Android Annotation - http://androidannotations.org/
https://github.com/Arasthel/SwissKnife[SwissKnife] para groovy.
. Osgi vs Jigsaw


== Enfoque usando el codigo de ejemplo
. https://github.com/josejuanmontiel/thymeleaf_talk
. https://github.com/josejuanmontiel/adorable-avatar
. https://github.com/josejuanmontiel/dynamic-rest-template

http://grooviter.github.io/asteroid/

== Bola extra
Algunas conversaciones en stackoverflow sobre android, groovy y generacion de codigo por APT

. http://stackoverflow.com/questions/31536234/android-annotations-multiple-paths-to-apt
. http://stackoverflow.com/questions/30991656/what-its-the-first-the-annotated-class-egg-or-used-class-chicken
. http://stackoverflow.com/questions/31160831/android-groovy-android-annotation
